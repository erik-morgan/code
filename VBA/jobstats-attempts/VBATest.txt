Sub Main ()
    Dim partRange As Range: Set partRange = Sheet1.UsedRange.Columns("A")
    For Each cell in partRange.Cells
        Dim partNum As String: partNum = cell.Value2
        Dim srcIE As String: srcIE = HTTPIE(partNum)
        Dim srcXHR As String: srcXHR = HTTPXHR(partNum)
        cell.Offset(0, 1).Value = srcIE
        cell.Offset(0, 2).Value = srcXHR
    Next cell
End Sub

Function HTTPIE (ByVal pn As String)
    Dim ie As Object: Set ie = CreateObject("InternetExplorer.application")
    Dim doc As HTMLDocument
    ie.Visible = False
    ie.navigate "http://houston/ErpWeb/WorkOrdersForPart.aspx?PartNumber=" & pn
    Do While ie.ReadyState <> 4: WScript.Sleep 100: Loop
    Set doc = ie.document
    Set ie = Nothing
    HTTPIE = doc.DocumentElement.innerHTML
End Function

Function HTTPXHR (ByVal pn As String)
    Dim http As Object
    Set http = CreateObject("MSXML2.XMLHTTP.6.0")
    http.Open "GET", "http://houston/ErpWeb/WorkOrdersForPart.aspx?PartNumber=" & pn, False
    http.send
    HTTPXHR = http.responseText
End Function
