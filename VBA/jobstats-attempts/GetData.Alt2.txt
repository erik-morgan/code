Public ws As Worksheet
Public regx As Object
Set regx = CreateObject("VBScript.RegExp")
With regx
    .Global = True
    .MultiLine = False
    .IgnoreCase = True
End With

Sub Main()
    Set ws = ActiveWorkbook.Sheets("PARTS")
    Dim partRange As Range: Set partRange = ws.UsedRange.Columns("A")
    For Each cell in partRange.Cells
        Dim partNum As String: partNum = cell.Value2
        regx.Pattern = "^[-A-Z0-9]{6,}$"
        If partNum <> vbNullString And regx.Test(partNum) Then
            ProcessPart(partNum)
        End If
    Next cell
End Sub

Function ProcessPart(ByVal pn As String)
    Dim jobs As String: jobs = GetJobs("http://houston/ErpWeb/WorkOrdersForPart.aspx?PartNumber=" & pn)
    Debug.Print jobs
End Function

Function GetJobs(ByVal url As String)
    Dim html As String: html = GetPage("http://houston/ErpWeb/WorkOrdersForPart.aspx?PartNumber=" & pn)
    If html = vbNullString Then
        ProcessPart = 1
        Exit Function
    End If
    Dim doc As New HTMLDocument, rows As Object
    doc.body.innerHTML = html
    Set rows = doc.getElementById("pageBody").getElementsByTagName("table")(2).getElementsByTagName("tr")
    For Each row In rows
        GetJobs = GetJobs & row.getElementsByTagName("a")(1).innerHTML & "|"
    Next row
    GetJobs = Left(GetJobs, Len(GetJobs)-1)
    ' GetJobs = Split(Right(jobs, Len(jobs)-1), "|")
End Function

Function GetPage(ByVal url As String)
    Dim http As Object
    Set http = CreateObject("MSXML2.XMLHTTP.6.0")
    For i = 1 to 5
        http.Open "GET", url, False
        http.send
        If http.status = 200 Then
            GetPage = http.responseText
            Exit Function
        End If
    Next i
    GetPage = ""
End Function
